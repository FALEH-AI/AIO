<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>AL3MFALEH | FiveM Dev Tool ğŸš€</title>
    <style>
        :root { --bg: #0a0a0b; --card: #1a1b26; --text: #a9b1d6; --accent: #7aa2f7; --green: #9ece6a; --red: #f7768e; --orange: #ff9e64; --info: #bb9af7; }
        body { font-family: 'Segoe UI', sans-serif; background-color: var(--bg); color: var(--text); margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .main-layout { display: flex; gap: 20px; width: 100%; max-width: 1200px; align-items: flex-start; }
        .right-side { flex: 1.5; display: flex; flex-direction: column; gap: 20px; }
        .left-side { flex: 1; display: flex; flex-direction: column; gap: 20px; position: sticky; top: 20px; }
        .container { background-color: var(--card); padding: 20px; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.3); border: 1px solid #24283b; position: relative; }
        h2 { text-align: center; color: var(--accent); margin: 0 0 20px 0; border-bottom: 2px solid #24283b; padding-bottom: 10px; font-size: 1.2rem; }
        .credits { text-align: center; font-size: 0.7rem; color: #565f89; margin-top: 15px; letter-spacing: 1px; }
        .credits b { color: var(--accent); }
        label { display: block; margin-bottom: 5px; font-weight: 600; color: #565f89; font-size: 0.8rem; }
        input, select { width: 100%; padding: 10px; margin-bottom: 10px; border-radius: 6px; border: 1px solid #24283b; background-color: #24283b; color: #c0caf5; box-sizing: border-box; }
        .row { display: flex; gap: 10px; flex-wrap: wrap; }
        .row div { flex: 1; }
        .switch-box { background: #16161e; padding: 12px; border-radius: 8px; margin-bottom: 10px; border: 1px solid #24283b; }
        .flex-label { display: flex; justify-content: space-between; align-items: center; }
        button { padding: 8px 12px; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; transition: 0.2s; font-size: 0.8rem; }
        
        .file-item { display: flex; justify-content: space-between; align-items: center; background: #24283b; padding: 10px; margin-bottom: 8px; border-radius: 6px; border-right: 3px solid var(--orange); gap: 10px; }
        .file-name { font-size: 0.8rem; color: var(--text); word-break: break-all; flex: 1; }

        .trigger-item { background-color: #24283b; padding: 15px; border-radius: 10px; margin-bottom: 10px; border-right: 4px solid var(--accent); }
        .item-header { display: flex; justify-content: space-between; align-items: center; }
        .info-panel { background: #16161e; padding: 10px; border-radius: 6px; display: none; margin-top: 10px; font-size: 0.75rem; border: 1px solid #414868; color: #9ece6a; white-space: pre-wrap; font-family: monospace; }
        .actions { display: flex; gap: 5px; }
        .btn-copy { background-color: var(--orange); color: #1a1b26; }
        .btn-send { background-color: var(--green); color: #1a1b26; }
        .btn-del { background-color: var(--red); color: #ffffff; }
        .disabled { opacity: 0.3; pointer-events: none; }
    </style>
</head>
<body onload="initApp()">

<div class="main-layout">
    <div class="right-side">
        <div class="container">
            <h2>ğŸ› ï¸ Ù…ÙˆÙ„Ø¯ Ø§Ù„ØªØ±ÙŠØ¬Ø±Ø§Øª | AL3MFALEH</h2>
            <div class="row">
                <div style="flex:2"><label>Ø§Ø³Ù… Ø§Ù„ØªØ±ÙŠØ¬Ø±:</label><input type="text" id="eventName" placeholder="esx:giveInventoryItem"></div>
                <div><label>Ø§Ù„Ù…Ø¹Ø·ÙŠØ§Øª:</label><input type="text" id="params" placeholder="id, 'bread', 1"></div>
            </div>

            <div class="switch-box">
                <div class="flex-label">
                    <label style="color:var(--green)">âŒ¨ï¸ ØªØ´ØºÙŠÙ„ Ø¨Ø¶ØºØ· Ø²Ø±</label>
                    <input type="checkbox" id="useKey" onchange="toggleFields()" style="width:18px">
                </div>
                <div id="keyInputs" class="row disabled">
                    <select id="controlId">
                        <option value="38">E (38)</option>
                        <option value="47">G (47)</option>
                        <option value="74">H (74)</option>
                        <option value="311">K (311)</option>
                        <option value="23">F (23)</option>
                    </select>
                </div>
            </div>

            <div class="switch-box">
                <div class="flex-label">
                    <label style="color:var(--orange)">ğŸ”„ Ø§Ù„ØªÙƒØ±Ø§Ø± ÙˆØ§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø¹Ø§Ù… (Loop)</label>
                    <input type="checkbox" id="useLoop" onchange="toggleFields()" style="width:18px">
                </div>
                <div id="loopInputs" class="row disabled">
                    <div><label>Ø§Ù„Ù…Ø±Ø§Øª:</label><input type="number" id="loopCount" value="10"></div>
                    <div><label>Wait (ms):</label><input type="number" id="delay" value="100"></div>
                </div>
            </div>

            <div class="switch-box">
                <div class="flex-label">
                    <label style="color:var(--accent)">ğŸ¯ Ù†Ø·Ø§Ù‚ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† (Range)</label>
                    <input type="checkbox" id="useRange" onchange="toggleFields()" style="width:18px">
                </div>
                <div id="rangeInputs" class="disabled">
                    <div class="row">
                        <input type="number" id="idFrom" value="1">
                        <input type="number" id="idTo" value="10">
                    </div>
                    <div style="margin-top:10px; border-top: 1px dotted #414868; padding-top:10px;">
                        <div class="flex-label">
                            <label style="font-size: 11px; color: #bb9af7;">â³ ØªØ´ØºÙŠÙ„ Wait Ø¯Ø§Ø®Ù„ Ø§Ù„Ø­Ù„Ù‚Ø©ØŸ</label>
                            <input type="checkbox" id="useRangeWait" checked style="width:15px">
                        </div>
                        <input type="number" id="rangeWaitMs" value="50">
                    </div>
                </div>
            </div>

            <button style="background-color: var(--accent); color: #1a1b26; width: 100%; margin-top: 5px; font-weight: bold;" onclick="addNewTrigger()">Ø­ÙØ¸ Ø§Ù„ØªØ±ÙŠØ¬Ø± âœ…</button>
            <div class="credits">Developed by <b>AL3MFALEH</b></div>
        </div>
        <div id="triggerList"></div>
    </div>

    <div class="left-side">
        <div class="container">
            <h2>âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ§Ù„Ù…Ù„ÙØ§Øª</h2>
            <label>Ø±Ø§Ø¨Ø· Ø§Ù„Ù€ Webhook:</label>
            <div style="display:flex; gap:5px; margin-bottom:15px">
                <input type="text" id="webhookUrl" disabled style="margin-bottom:0">
                <button onclick="toggleWebhookEdit()" id="editWebhookBtn" style="background:var(--info); color:#000">âœï¸</button>
            </div>
            
            <hr style="border: 0; border-top: 1px solid #24283b; margin: 15px 0;">
            
            <div style="border: 2px dashed #414868; padding: 15px; text-align: center; border-radius: 8px; margin-bottom: 15px; background: #16161e;">
                <input type="file" id="fileInput" style="display:none" onchange="handleFileUpload(this)" multiple>
                <label for="fileInput" style="cursor:pointer; color:var(--accent); font-weight:bold;">Ø±ÙØ¹ Ù…Ù„ÙØ§Øª â•</label>
            </div>

            <div id="fileList"></div>
            <div class="credits">Owner: <b>AL3MFALEH</b></div>
        </div>
    </div>
</div>

<script>
    let triggers = JSON.parse(localStorage.getItem('v22Triggers')) || [];
    let savedFiles = JSON.parse(localStorage.getItem('savedFiles')) || [];
    let isEditingWebhook = false;

    // ØªÙ… Ø­ÙØ¸ Ø§Ù„ÙˆÙŠØ¨ Ù‡ÙˆÙƒ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù‡Ù†Ø§ Ù„ÙŠÙƒÙˆÙ† Ø¬Ø§Ù‡Ø²Ø§Ù‹ Ø¯ÙˆÙ…Ø§Ù‹
    const DEFAULT_WEBHOOK = "https://discord.com/api/webhooks/1457948265982070837/sHmtRLLGr7t3Q6eCjE652iYRpSFWzX_A4twQl9MIPj3vVv_f1hm_r8_B6gvCIe3-E2Q2";

    function initApp() { 
        renderTriggers(); 
        renderFiles(); 
        toggleFields(); 
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙˆÙŠØ¨ Ù‡ÙˆÙƒ ÙˆØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙˆØ¬Ø¯ ÙˆØ§Ø­Ø¯ Ù…Ø­ÙÙˆØ¸
        if (!localStorage.getItem('masterWebhook')) {
            localStorage.setItem('masterWebhook', DEFAULT_WEBHOOK);
        }
        
        document.getElementById('webhookUrl').value = localStorage.getItem('masterWebhook');
    }

    // Ø¯Ø§Ù„Ø© Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙˆÙŠØ¨ Ù‡ÙˆÙƒ ÙŠØ¯ÙˆÙŠØ§Ù‹
    function toggleWebhookEdit() {
        const input = document.getElementById('webhookUrl');
        const btn = document.getElementById('editWebhookBtn');
        if (!isEditingWebhook) { 
            input.disabled = false; 
            input.focus(); 
            btn.innerText = "âœ…"; 
            isEditingWebhook = true; 
        }
        else { 
            localStorage.setItem('masterWebhook', input.value); 
            input.disabled = true; 
            btn.innerText = "âœï¸"; 
            isEditingWebhook = false; 
        }
    }

    function toggleFields() {
        document.getElementById('loopInputs').className = document.getElementById('useLoop').checked ? 'row' : 'row disabled';
        document.getElementById('keyInputs').className = document.getElementById('useKey').checked ? 'row' : 'row disabled';
        document.getElementById('rangeInputs').className = document.getElementById('useRange').checked ? '' : 'disabled';
    }

    function generateLua(t) {
        const safeName = t.name.replace(/"/g, "'");
        let p = t.params ? t.params.trim() : "";
        if (t.useRange) { p = p.replace(/\bid\b/gi, "pID"); }
        const needsThread = t.useKey || t.useLoop || t.useRange;
        let bI = needsThread ? "    " : "";
        if (t.useKey) bI = "            ";
        else if (t.useLoop || t.useRange) bI = "        ";

        let logic = t.useRange ? 
            `${bI}for pID = ${t.idFrom}, ${t.idTo} do\n${bI}    TriggerServerEvent('${safeName}'${p ? ', '+p : ''})\n${t.useRangeWait ? bI+'    Citizen.Wait('+t.rangeWaitMs+')\n' : ''}${bI}end` : 
            `${bI}TriggerServerEvent('${safeName}'${p ? ', '+p : ''})`;

        if (t.useLoop) {
            let lI = t.useKey ? "        " : "    ";
            logic = `${lI}for i = 1, ${t.loopCount} do\n${logic}\n${t.delay > 0 ? lI + '    Citizen.Wait(' + t.delay + ')\n' : ''}${lI}end`;
        }

        if (t.useKey) {
            return `Citizen.CreateThread(function()\n    while true do\n        Citizen.Wait(0)\n        if IsControlJustReleased(0, ${t.controlId}) then\n${logic}\n        end\n    end\nend)`;
        } else if (t.useLoop || t.useRange) {
            return `Citizen.CreateThread(function()\n${logic}\nend)`;
        } else {
            return `TriggerServerEvent('${safeName}'${p ? ', '+p : ''})`;
        }
    }

    function handleFileUpload(input) {
        for (let f of input.files) {
            const r = new FileReader();
            r.onload = (e) => {
                savedFiles.push({id: Date.now() + Math.random(), name: f.name, content: e.target.result});
                localStorage.setItem('savedFiles', JSON.stringify(savedFiles));
                renderFiles();
            };
            r.readAsText(f);
        }
    }

    function renderFiles() {
        document.getElementById('fileList').innerHTML = savedFiles.map(f => `
            <div class="file-item">
                <span class="file-name">ğŸ“„ ${f.name}</span>
                <div class="actions">
                    <button class="btn-copy" onclick="copyFileContent(${f.id})">Ù†Ø³Ø®</button>
                    <button class="btn-del" onclick="deleteFile(${f.id})">ğŸ—‘ï¸</button>
                </div>
            </div>
        `).join('');
    }

    function copyFileContent(id) {
        const f = savedFiles.find(x => x.id === id);
        navigator.clipboard.writeText(f.content).then(() => alert("ØªÙ… Ù†Ø³Ø® Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù„Ù!"));
    }

    function deleteFile(id) {
        if(confirm("Ø­Ø°Ù Ø§Ù„Ù…Ù„ÙØŸ")) {
            savedFiles = savedFiles.filter(f => f.id !== id);
            localStorage.setItem('savedFiles', JSON.stringify(savedFiles));
            renderFiles();
        }
    }

    function addNewTrigger() {
        triggers.push({
            id: Date.now(),
            name: document.getElementById('eventName').value || "Event",
            params: document.getElementById('params').value,
            useLoop: document.getElementById('useLoop').checked,
            loopCount: document.getElementById('loopCount').value,
            delay: document.getElementById('delay').value,
            useKey: document.getElementById('useKey').checked,
            controlId: document.getElementById('controlId').value,
            useRange: document.getElementById('useRange').checked,
            idFrom: document.getElementById('idFrom').value,
            idTo: document.getElementById('idTo').value,
            useRangeWait: document.getElementById('useRangeWait').checked,
            rangeWaitMs: document.getElementById('rangeWaitMs').value
        });
        localStorage.setItem('v22Triggers', JSON.stringify(triggers));
        renderTriggers();
    }

    function renderTriggers() {
        document.getElementById('triggerList').innerHTML = triggers.map(t => `
            <div class="trigger-item">
                <div class="item-header">
                    <b>ğŸš€ ${t.name}</b>
                    <div class="actions">
                        <button style="background:var(--info)" onclick="toggleInfo(${t.id})">ğŸ“œ</button>
                        <button class="btn-copy" onclick="copyTrigger(${t.id})">Ù†Ø³Ø®</button>
                        <button class="btn-send" onclick="sendToDiscord(${t.id})">ğŸ“¡</button>
                        <button class="btn-del" onclick="deleteTrigger(${t.id})">ğŸ—‘ï¸</button>
                    </div>
                </div>
                <div id="info-${t.id}" class="info-panel">${generateLua(t)}</div>
            </div>
        `).join('');
    }

    function toggleInfo(id) { const el = document.getElementById(`info-${id}`); el.style.display = el.style.display === 'block' ? 'none' : 'block'; }
    function copyTrigger(id) { navigator.clipboard.writeText(generateLua(triggers.find(t => t.id === id))).then(() => alert("ØªÙ… Ø§Ù„Ù†Ø³Ø®!")); }
    function deleteTrigger(id) { triggers = triggers.filter(t => t.id !== id); localStorage.setItem('v22Triggers', JSON.stringify(triggers)); renderTriggers(); }
    async function sendToDiscord(id) {
        const url = localStorage.getItem('masterWebhook');
        if (!url) return alert("Ø§Ø­ÙØ¸ Ø§Ù„ÙˆÙŠØ¨ Ù‡ÙˆÙƒ Ø£ÙˆÙ„Ø§Ù‹!");
        const t = triggers.find(tr => tr.id === id);
        await fetch(url, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({embeds:[{title:"ğŸ“¡ Export | AL3MFALEH", color:7506394, description:"```lua\n"+generateLua(t)+"\n```"}]}) });
        alert("ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„!");
    }
</script>
</body>
</html>